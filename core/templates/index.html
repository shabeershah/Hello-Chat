{% extends  "base.html" %}
{% block head %}
    <title>Hello Chat</title>
{% endblock %}
{% block content %}
    <style>
        .comment_picture {
            display: block;
            float: left;
            margin-right: 10px;
        }

        .comment_char {
            height: 40px;
            width: 40px;
            background: #F05523;
            color: #fff;
            border: 5px solid #F05523;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
        }

        .msg_received {
            background: #2346F0 !important;
            border: 5px solid #2346F0 !important;
        }

        .prof_pic {
            height: 30px !important;
            width: 30px  !important;
            line-height: 21px  !important;

        }
    </style>
    <div class="col-lg-12" style="margin-top:3%">
        <div class="chat-panel panel panel-default" style="display: none">
            <div class="panel-heading">
                <i class="fa fa-comments fa-fw" id="chat_icon"></i>
                <span id="chat_person">Chat</span>

                <div class="btn-group pull-right">
                    <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-chevron-down"></i>
                    </button>
                    <ul class="dropdown-menu slidedown">
                        <li>
                            <a id="clear_window">
                                <i class="fa fa-check-circle fa-fw"></i> Clear window
                            </a>
                        </li>
                        <li>
                            <a id="delete_msgs">
                                <i class="fa fa-times fa-fw"></i> Delete Messages
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body" id="chat_window">
                <ul class="chat">

                </ul>
            </div>
            <!-- /.panel-body -->
            <div class="panel-footer">
                <div class="input-group">
                    <input id="msg-input" type="text" class="form-control input-sm"
                           placeholder="Type your message here..."/>
                                <span class="input-group-btn">
                                    <button class="btn btn-warning btn-sm" id="btn-chat" onclick="post_message();">
                                        Send
                                    </button>
                                </span>
                </div>
            </div>
            <!-- /.panel-footer -->
        </div>
        <!-- /.panel .chat-panel -->
    </div>
    <!-- /.col-lg-4 -->
{% endblock %}

{% block script %}
    <script>
        $(document).ready(function () {
            MESSAGE_TO = {{ request.user.id }}
                    fetch_friends({{ request.user.id }});
            fetch_new_messages({{ request.user.id }})
        });
        setInterval(function () {
            fetch_friends({{ request.user.id }});
            fetch_new_messages({{ request.user.id }})
        }, 5000);
    </script>

{% endblock %}